{
  "helpers": [
    {
      "name": "get_theme_by_name",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "theme_name",
          "type": "string",
          "required": true,
          "default": null,
          "description": "Theme name to look up"
        }
      ],
      "purpose": "Get theme by name (fairly frequent)",
      "error_handling": "",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [],
      "implementation_notes": [
        "Returns: Theme object {id, name, description, ai_generated, confidence_score} or null",
        "Queries themes table WHERE name = theme_name"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "project_theme_flow_mapping",
          "execution_context": "infer_metadata",
          "sequence_order": 1,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Check if theme exists before mapping file - validates theme name from file metadata"
        },
        {
          "directive_name": "aifp_init",
          "execution_context": "create_project_structure",
          "sequence_order": 3,
          "is_required": false,
          "parameters_mapping": {},
          "description": "Check if default themes already exist during initialization - prevents duplicates"
        }
      ]
    },
    {
      "name": "get_flow_by_name",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "flow_name",
          "type": "string",
          "required": true,
          "default": null,
          "description": "Flow name to look up"
        }
      ],
      "purpose": "Get flow by name (fairly frequent)",
      "error_handling": "",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [],
      "implementation_notes": [
        "Returns: Flow object {id, name, description, theme_id} or null",
        "Queries flows table WHERE name = flow_name"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "project_theme_flow_mapping",
          "execution_context": "infer_metadata",
          "sequence_order": 2,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Check if flow exists before mapping file - validates flow name from file metadata"
        },
        {
          "directive_name": "aifp_init",
          "execution_context": "create_project_structure",
          "sequence_order": 4,
          "is_required": false,
          "parameters_mapping": {},
          "description": "Check if default flows already exist during initialization - prevents duplicates"
        }
      ]
    },
    {
      "name": "get_all_themes",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [],
      "purpose": "Get all project themes",
      "error_handling": "",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [],
      "implementation_notes": [
        "Returns: Array of theme objects [{id, name, description, ai_generated, confidence_score}, ...]",
        "Queries SELECT * FROM themes"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "project_blueprint_read",
          "execution_context": "database_fallback",
          "sequence_order": 3,
          "is_required": false,
          "parameters_mapping": {},
          "description": "Query all themes when blueprint missing - retrieves theme list from database for fallback"
        },
        {
          "directive_name": "project_evolution",
          "execution_context": "detect_project_wide_change",
          "sequence_order": 2,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Read current themes for evolution tracking - compares against blueprint to detect theme changes"
        },
        {
          "directive_name": "aifp_status",
          "execution_context": "get_existing_project_status",
          "sequence_order": 3,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Read all project themes for status report - provides comprehensive theme list"
        }
      ]
    },
    {
      "name": "get_all_flows",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [],
      "purpose": "Get all project flows",
      "error_handling": "",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [],
      "implementation_notes": [
        "Returns: Array of flow objects [{id, name, description, theme_id}, ...]",
        "Queries SELECT * FROM flows"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "project_blueprint_read",
          "execution_context": "database_fallback",
          "sequence_order": 4,
          "is_required": false,
          "parameters_mapping": {},
          "description": "Query all flows when blueprint missing - retrieves flow list from database for fallback"
        },
        {
          "directive_name": "project_evolution",
          "execution_context": "detect_project_wide_change",
          "sequence_order": 3,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Read current flows for evolution tracking - compares against blueprint to detect flow changes"
        },
        {
          "directive_name": "aifp_status",
          "execution_context": "get_existing_project_status",
          "sequence_order": 4,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Read all project flows for status report - provides comprehensive flow list"
        }
      ]
    },
    {
      "name": "add_theme",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "name",
          "type": "string",
          "required": true,
          "default": null,
          "description": "Theme name"
        },
        {
          "name": "description",
          "type": "string",
          "required": false,
          "default": null,
          "description": "Theme description"
        },
        {
          "name": "ai_generated",
          "type": "boolean",
          "required": true,
          "default": true,
          "description": "True if AI-generated, False if user-created"
        },
        {
          "name": "confidence_score",
          "type": "number",
          "required": false,
          "default": 0.0,
          "description": "Confidence score 0-1"
        }
      ],
      "purpose": "Add project theme",
      "error_handling": "",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [],
      "implementation_notes": [
        "Returns: {success: true, id: int} - new theme ID",
        "Inserts into themes table",
        "If ai_generated=true → may trigger project_evolution"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "aifp_init",
          "execution_context": "create_project_structure",
          "sequence_order": 5,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Create initial project themes during initialization - populates themes from blueprint prompts"
        },
        {
          "directive_name": "project_theme_flow_mapping",
          "execution_context": "new_theme_created",
          "sequence_order": 3,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Create new theme when mapping file with unknown theme - adds theme and triggers project_evolution"
        }
      ]
    },
    {
      "name": "update_theme",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "theme_id",
          "type": "integer",
          "required": true,
          "default": null,
          "description": "Theme ID to update"
        },
        {
          "name": "name",
          "type": "string",
          "required": false,
          "default": null,
          "description": "New name (NULL = don't update)"
        },
        {
          "name": "description",
          "type": "string",
          "required": false,
          "default": null,
          "description": "New description (NULL = don't update)"
        },
        {
          "name": "confidence_score",
          "type": "number",
          "required": false,
          "default": null,
          "description": "New confidence score (NULL = don't update)"
        }
      ],
      "purpose": "Update theme metadata",
      "error_handling": "Error if no update fields provided",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [
        "Call add_note(note_type='evolution', directive_name='project_evolution', reference_table='themes', reference_id=<theme_id>) describing the theme change"
      ],
      "implementation_notes": [
        "Returns: {success: true}",
        "NULL parameters = don't update that field",
        "Error if all parameters are NULL"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "project_evolution",
          "execution_context": "detect_project_wide_change",
          "sequence_order": 4,
          "is_required": false,
          "parameters_mapping": {},
          "description": "Update theme metadata when themes change - synchronizes theme description and confidence scores"
        }
      ]
    },
    {
      "name": "delete_theme",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "theme_id",
          "type": "integer",
          "required": true,
          "default": null,
          "description": "Theme ID to delete"
        },
        {
          "name": "note_reason",
          "type": "string",
          "required": true,
          "default": null,
          "description": "Deletion reason"
        },
        {
          "name": "note_severity",
          "type": "string",
          "required": true,
          "default": null,
          "description": "'info', 'warning', 'error'"
        },
        {
          "name": "note_source",
          "type": "string",
          "required": true,
          "default": null,
          "description": "'ai' or 'user'"
        },
        {
          "name": "note_type",
          "type": "string",
          "required": true,
          "default": "entry_deletion",
          "description": "'entry_deletion'"
        }
      ],
      "purpose": "Delete theme with flow validation",
      "error_handling": "- Calls `get_flows_for_theme(theme_id)`",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [],
      "implementation_notes": [
        "Returns error if flows exist linked to theme",
        "Returns success after deletion with audit note",
        "Queries flows table to validate no relationships"
      ],
      "target_database": "project",
      "used_by_directives": []
    },
    {
      "name": "add_flow",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "name",
          "type": "string",
          "required": true,
          "default": null,
          "description": "Flow name"
        },
        {
          "name": "description",
          "type": "string",
          "required": false,
          "default": null,
          "description": "Flow description"
        },
        {
          "name": "ai_generated",
          "type": "boolean",
          "required": true,
          "default": true,
          "description": "True if AI-generated"
        },
        {
          "name": "confidence_score",
          "type": "number",
          "required": false,
          "default": 0.0,
          "description": "Confidence score 0-1"
        }
      ],
      "purpose": "Add project flow",
      "error_handling": "",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [
        "Consider linking relevant files to this flow in file_flows table"
      ],
      "implementation_notes": [
        "Returns: {success: true, id: int} - new flow ID",
        "Inserts into flows table",
        "If ai_generated=true → may trigger project_evolution"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "aifp_init",
          "execution_context": "create_project_structure",
          "sequence_order": 6,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Create initial project flows during initialization - populates flows from blueprint prompts"
        },
        {
          "directive_name": "project_theme_flow_mapping",
          "execution_context": "new_flow_created",
          "sequence_order": 4,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Create new flow when mapping file with unknown flow - adds flow and triggers project_evolution"
        }
      ]
    },
    {
      "name": "get_file_ids_from_flows",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "flow_ids",
          "type": "array",
          "required": true,
          "default": null,
          "description": "Array of flow IDs [1, 3, 5]"
        }
      ],
      "purpose": "Get all file IDs associated with flows",
      "error_handling": "",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [],
      "implementation_notes": [
        "Returns: Array of file IDs [int, ...]",
        "Queries file_flows table for flow_ids IN (...)",
        "Deduplicates file IDs"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "project_dependency_map",
          "execution_context": "generate_dependency_graph",
          "sequence_order": 4,
          "is_required": true,
          "parameters_mapping": {},
          "description": "Query files by flow IDs for dependency graph - maps flow-to-file relationships"
        }
      ]
    },
    {
      "name": "update_flow",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "flow_id",
          "type": "integer",
          "required": true,
          "default": null,
          "description": "Flow ID to update"
        },
        {
          "name": "name",
          "type": "string",
          "required": false,
          "default": null,
          "description": "New name (NULL = don't update)"
        },
        {
          "name": "description",
          "type": "string",
          "required": false,
          "default": null,
          "description": "New description (NULL = don't update)"
        },
        {
          "name": "confidence_score",
          "type": "number",
          "required": false,
          "default": null,
          "description": "New confidence score (NULL = don't update)"
        }
      ],
      "purpose": "Update flow metadata",
      "error_handling": "Error if no update fields provided",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [
        "Call add_note(note_type='evolution', directive_name='project_evolution', reference_table='flows', reference_id=<flow_id>) describing the flow change"
      ],
      "implementation_notes": [
        "Returns: {success: true}",
        "NULL parameters = don't update",
        "Error if all NULL"
      ],
      "target_database": "project",
      "used_by_directives": [
        {
          "directive_name": "project_evolution",
          "execution_context": "detect_project_wide_change",
          "sequence_order": 5,
          "is_required": false,
          "parameters_mapping": {},
          "description": "Update flow metadata when flows change - synchronizes flow description and confidence scores"
        }
      ]
    },
    {
      "name": "delete_flow",
      "file_path": "helpers/project/themes_flows_1.py",
      "parameters": [
        {
          "name": "flow_id",
          "type": "integer",
          "required": true,
          "default": null,
          "description": "Flow ID to delete"
        },
        {
          "name": "note_reason",
          "type": "string",
          "required": true,
          "default": null,
          "description": "Deletion reason"
        },
        {
          "name": "note_severity",
          "type": "string",
          "required": true,
          "default": null,
          "description": "'info', 'warning', 'error'"
        },
        {
          "name": "note_source",
          "type": "string",
          "required": true,
          "default": null,
          "description": "'ai' or 'user'"
        },
        {
          "name": "note_type",
          "type": "string",
          "required": true,
          "default": "entry_deletion",
          "description": "'entry_deletion'"
        }
      ],
      "purpose": "Delete flow with file validation",
      "error_handling": "- Calls `get_files_by_flow(flow_id)`",
      "is_tool": true,
      "is_sub_helper": false,
      "return_statements": [],
      "implementation_notes": [
        "ERROR LOGIC: Query tasks WHERE status IN ('pending', 'in_progress', 'blocked') - check flow_ids JSON array for flow_id",
        "ERROR LOGIC: Query sidequests WHERE status IN ('pending', 'in_progress') - check flow_ids JSON array for flow_id",
        "ERROR RETURN: {success: false, error: 'flow_in_use', tasks: [...], sidequests: [...]}",
        "ERROR MESSAGE: 'Cannot delete flow - open tasks/sidequests reference this flow. Update or complete them first, then retry'",
        "SUCCESS LOGIC: Only proceed if no open tasks/sidequests contain flow_id in their flow_ids arrays",
        "SUCCESS LOGIC: Returns error if files linked to flow via file_flows table",
        "SUCCESS LOGIC: Creates audit note for deletion",
        "SUCCESS RETURN: {success: true, deleted_flow_id: flow_id}"
      ],
      "target_database": "project",
      "used_by_directives": []
    }
  ],
  "metadata": {
    "file": "helpers-project-5.json",
    "count": 11,
    "range": "helpers 49-59 of 112",
    "description": "Theme and flow management operations (add, get, update, delete, relationships)",
    "first_helper": "get_theme_by_name",
    "last_helper": "delete_flow",
    "status": "return_statements complete - 1 helper enhanced",
    "last_updated": "2026-01-02",
    "notes": "delete_flow includes comprehensive validation for tasks/sidequests flow_ids JSON arrays"
  }
}