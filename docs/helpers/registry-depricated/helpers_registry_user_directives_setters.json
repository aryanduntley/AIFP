{
  "metadata": {
    "version": "1.0.0",
    "last_updated": "2025-11-27",
    "description": "User Directives Database helpers - WRITE operations (setters, add, update, delete)",
    "database": "user_directives.db",
    "total_helpers": 33,
    "schema_version": "1.0",
    "notes": "This registry is for import into MCP database. User directives is AI territory - AI is encouraged to write custom queries and mutations if helpers don't satisfy needs."
  },
  "helper_schema": {
    "description": "Schema definition for helper entries",
    "fields": {
      "name": "Function name",
      "file_path": "Path to implementation file",
      "database": "Which database this helper operates on",
      "purpose": "Detailed description of what this helper does",
      "parameters": "Array of parameter objects with name and type",
      "return_statements": "Array of AI behavioral guidance - what to check/do next after calling this helper",
      "error_handling": "How errors are handled",
      "used_by_directives": "Array of directive names that use this helper",
      "is_tool": "Boolean - exposed via MCP as tool",
      "is_sub_helper": "Boolean - internal utility helper not directly called by AI/directives",
      "calls_helpers": "Array of helper names this function calls",
      "category": "Functional category"
    }
  },
  "database": "user_directives.db",
  "file_location": "src/aifp/helpers/user_directives/",
  "note_to_ai": "AI has freedom to write custom SQL mutations for user_directives.db when existing helpers are insufficient. These setters are guides - feel empowered to create optimized insert/update/delete queries for specific needs.",
  "helpers": [
    {
      "name": "add_user_directive",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Create new user directive entry with all metadata.",
      "parameters": [
        {"name": "name", "type": "str", "required": true},
        {"name": "source_file", "type": "str", "required": true},
        {"name": "source_format", "type": "str", "required": true},
        {"name": "domain", "type": "str", "required": true},
        {"name": "description", "type": "str", "required": true},
        {"name": "raw_content", "type": "str", "required": true},
        {"name": "validated_content", "type": "str", "required": true},
        {"name": "trigger_type", "type": "str", "required": true},
        {"name": "trigger_config", "type": "str", "required": true},
        {"name": "action_type", "type": "str", "required": true},
        {"name": "action_config", "type": "str", "required": true},
        {"name": "status", "type": "str", "required": true},
        {"name": "implementation_status", "type": "str", "required": true},
        {"name": "implementation_file_path", "type": "str", "required": true},
        {"name": "validation_questions", "type": "str", "required": true},
        {"name": "validation_answers", "type": "str", "required": true},
        {"name": "validated_by", "type": "str", "required": true},
        {"name": "approved", "type": "bool", "required": true},
        {"name": "priority", "type": "str", "required": true},
        {"name": "activated_at", "type": "str", "required": false, "default": null},
        {"name": "last_modified_at", "type": "str", "required": false, "default": null},
        {"name": "validated_at", "type": "str", "required": false, "default": null},
        {"name": "approved_at", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "Returns new directive ID for reference in other operations",
        "After adding, proceed to add_user_directive_dependency for any required packages",
        "Then add_user_directive_implementation to link generated code files",
        "Status should typically start as 'pending' until validation complete",
        "Implementation_status should start as 'not_implemented' until code generated"
      ],
      "error_handling": "Return error if name already exists or required fields invalid.",
      "used_by_directives": ["user_directive_parse", "user_directive_validate"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_mutations"
    },
    {
      "name": "update_user_directive",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update user directive fields. All parameters except id are optional (null = don't update).",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "name", "type": "str", "required": false, "default": null},
        {"name": "source_file", "type": "str", "required": false, "default": null},
        {"name": "source_format", "type": "str", "required": false, "default": null},
        {"name": "domain", "type": "str", "required": false, "default": null},
        {"name": "description", "type": "str", "required": false, "default": null},
        {"name": "raw_content", "type": "str", "required": false, "default": null},
        {"name": "validated_content", "type": "str", "required": false, "default": null},
        {"name": "trigger_type", "type": "str", "required": false, "default": null},
        {"name": "trigger_config", "type": "str", "required": false, "default": null},
        {"name": "action_type", "type": "str", "required": false, "default": null},
        {"name": "action_config", "type": "str", "required": false, "default": null},
        {"name": "status", "type": "str", "required": false, "default": null},
        {"name": "implementation_status", "type": "str", "required": false, "default": null},
        {"name": "implementation_file_path", "type": "str", "required": false, "default": null},
        {"name": "validation_questions", "type": "str", "required": false, "default": null},
        {"name": "validation_answers", "type": "str", "required": false, "default": null},
        {"name": "validated_by", "type": "str", "required": false, "default": null},
        {"name": "approved", "type": "bool", "required": false, "default": null},
        {"name": "priority", "type": "str", "required": false, "default": null},
        {"name": "activated_at", "type": "str", "required": false, "default": null},
        {"name": "last_modified_at", "type": "str", "required": false, "default": null},
        {"name": "validated_at", "type": "str", "required": false, "default": null},
        {"name": "approved_at", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "At least one non-id parameter must be provided for update",
        "If status changed to 'active', verify implementation_status is 'deployed'",
        "If approved changed to true, set approved_at timestamp",
        "After update, check if directive_implementations need updating"
      ],
      "error_handling": "Return error if id not found or no update values provided.",
      "used_by_directives": ["user_directive_update", "user_directive_validate", "user_directive_approve"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_mutations"
    },
    {
      "name": "delete_user_directive",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Delete user directive and all related entries (cascade).",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "DANGER: This cascades to delete dependencies, implementations, helpers, relationships",
        "Confirm with user before proceeding - this is permanent",
        "If directive is active, must deactivate first",
        "Verify no other directives depend on this one via directive_relationships",
        "After deletion, clean up generated implementation files if they exist"
      ],
      "error_handling": "Return error if directive is active. Require deactivation first.",
      "used_by_directives": ["user_directive_deactivate"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": ["deactivate_directive"],
      "category": "directive_mutations"
    },
    {
      "name": "set_user_directive_approved",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Set directive approved status and approved_at timestamp.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "approved_at", "type": "str", "required": true}
      ],
      "return_statements": [
        "Sets approved=true and approved_at timestamp",
        "After approval, directive can proceed to activation",
        "Approval should only happen after user testing implementation",
        "Consider updating status to 'approved' if currently 'pending'"
      ],
      "error_handling": "Return error if id not found.",
      "used_by_directives": ["user_directive_approve"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_mutations"
    },
    {
      "name": "set_user_directive_validated",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Set directive validated status with optional updates to validated content and questions/answers.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "validated_at", "type": "str", "required": true},
        {"name": "validated_content", "type": "str", "required": false, "default": null},
        {"name": "validation_questions", "type": "str", "required": false, "default": null},
        {"name": "validation_answers", "type": "str", "required": false, "default": null},
        {"name": "validated_by", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "After validation, directive is ready for implementation",
        "Store validation Q&A for future reference and re-parsing",
        "Consider updating status to 'validated' if currently 'pending'",
        "Proceed to user_directive_implement after successful validation"
      ],
      "error_handling": "Return error if id not found.",
      "used_by_directives": ["user_directive_validate"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_mutations"
    },
    {
      "name": "set_user_directive_modified",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update last_modified_at timestamp when source file changes detected.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "last_modified_at", "type": "str", "required": true}
      ],
      "return_statements": [
        "Call this when source file checksum changes",
        "After setting modified, trigger re-validation via user_directive_update",
        "May need to re-parse and re-validate if changes are significant"
      ],
      "error_handling": "Return error if id not found.",
      "used_by_directives": ["user_directive_update"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_mutations"
    },
    {
      "name": "set_user_directive_activate",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Set directive active status and activated_at timestamp.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "active", "type": "bool", "required": true},
        {"name": "activated_at", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "If active=true, ensure approved=true and implementation_status='deployed'",
        "If active=true and activated_at=null, set current timestamp",
        "If active=false (deactivation), stop background service/scheduler",
        "After activation, monitor via user_directive_monitor"
      ],
      "error_handling": "Return error if activating without approval or deployment.",
      "used_by_directives": ["user_directive_activate", "user_directive_deactivate"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_mutations"
    },
    {
      "name": "add_user_directive_execution",
      "file_path": "src/aifp/helpers/user_directives/tools/execution_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Add execution statistics entry for directive.",
      "parameters": [
        {"name": "directive_id", "type": "int", "required": true},
        {"name": "last_execution_time", "type": "str", "required": true},
        {"name": "next_scheduled_time", "type": "str", "required": true},
        {"name": "total_executions", "type": "int", "required": true},
        {"name": "success_count", "type": "int", "required": true},
        {"name": "error_count", "type": "int", "required": true},
        {"name": "last_error_time", "type": "str", "required": false, "default": null},
        {"name": "last_error_type", "type": "str", "required": false, "default": null},
        {"name": "last_error_message", "type": "str", "required": false, "default": null},
        {"name": "avg_execution_time_ms", "type": "float", "required": true},
        {"name": "max_execution_time_ms", "type": "float", "required": true}
      ],
      "return_statements": [
        "Create execution record when directive first activates",
        "Initialize all counts to 0 for new directives",
        "Detailed logs go to .aifp-project/logs/, not database",
        "This stores summary statistics only"
      ],
      "error_handling": "Return error if directive_id not found.",
      "used_by_directives": ["user_directive_activate"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "execution_mutations"
    },
    {
      "name": "update_user_directive_execution",
      "file_path": "src/aifp/helpers/user_directives/tools/execution_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update execution statistics. All parameters except id optional.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "directive_id", "type": "int", "required": false, "default": null},
        {"name": "last_execution_time", "type": "str", "required": false, "default": null},
        {"name": "next_scheduled_time", "type": "str", "required": false, "default": null},
        {"name": "total_executions", "type": "int", "required": false, "default": null},
        {"name": "success_count", "type": "int", "required": false, "default": null},
        {"name": "error_count", "type": "int", "required": false, "default": null},
        {"name": "last_error_time", "type": "str", "required": false, "default": null},
        {"name": "last_error_type", "type": "str", "required": false, "default": null},
        {"name": "last_error_message", "type": "str", "required": false, "default": null},
        {"name": "avg_execution_time_ms", "type": "float", "required": false, "default": null},
        {"name": "max_execution_time_ms", "type": "float", "required": false, "default": null}
      ],
      "return_statements": [
        "Call this after each directive execution to update stats",
        "Increment total_executions and success_count/error_count accordingly",
        "Update avg_execution_time_ms using running average formula",
        "Update max_execution_time_ms if current execution exceeded previous max"
      ],
      "error_handling": "Return error if id not found or no update values provided.",
      "used_by_directives": ["user_directive_monitor"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "execution_mutations"
    },
    {
      "name": "delete_user_directive_execution",
      "file_path": "src/aifp/helpers/user_directives/tools/execution_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Delete execution statistics record.",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "Use this to reset statistics for directive",
        "Typically called when directive is deactivated or reset",
        "Execution logs in files remain - only database stats deleted"
      ],
      "error_handling": "Return error if id not found.",
      "used_by_directives": ["user_directive_deactivate"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "execution_mutations"
    },
    {
      "name": "add_user_directive_dependency",
      "file_path": "src/aifp/helpers/user_directives/tools/dependency_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Add dependency requirement for directive (package, API, env var, etc.).",
      "parameters": [
        {"name": "directive_id", "type": "int", "required": true},
        {"name": "dependency_type", "type": "str", "required": true},
        {"name": "dependency_name", "type": "str", "required": true},
        {"name": "dependency_version", "type": "str", "required": true},
        {"name": "status", "type": "str", "required": true},
        {"name": "install_command", "type": "str", "required": true},
        {"name": "user_confirmed", "type": "bool", "required": true},
        {"name": "confirmed_at", "type": "str", "required": false, "default": null},
        {"name": "installed_at", "type": "str", "required": false, "default": null},
        {"name": "required", "type": "bool", "required": true},
        {"name": "description", "type": "str", "required": true}
      ],
      "return_statements": [
        "Always get user confirmation before installing dependencies",
        "Status should start as 'pending' until user confirms",
        "If required=true, directive cannot run without this dependency",
        "Store install_command for user reference - don't execute automatically"
      ],
      "error_handling": "Return error if directive_id not found.",
      "used_by_directives": ["user_directive_implement"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "dependency_mutations"
    },
    {
      "name": "update_user_directive_dependency",
      "file_path": "src/aifp/helpers/user_directives/tools/dependency_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update dependency status and metadata. All parameters except id optional.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "directive_id", "type": "int", "required": false, "default": null},
        {"name": "dependency_type", "type": "str", "required": false, "default": null},
        {"name": "dependency_name", "type": "str", "required": false, "default": null},
        {"name": "dependency_version", "type": "str", "required": false, "default": null},
        {"name": "status", "type": "str", "required": false, "default": null},
        {"name": "install_command", "type": "str", "required": false, "default": null},
        {"name": "user_confirmed", "type": "bool", "required": false, "default": null},
        {"name": "confirmed_at", "type": "str", "required": false, "default": null},
        {"name": "installed_at", "type": "str", "required": false, "default": null},
        {"name": "required", "type": "bool", "required": false, "default": null},
        {"name": "description", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "Update status to 'installed' after successful installation",
        "Set installed_at timestamp when status becomes 'installed'",
        "If user_confirmed changes to true, set confirmed_at timestamp"
      ],
      "error_handling": "Return error if id not found or no update values provided.",
      "used_by_directives": ["user_directive_implement"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "dependency_mutations"
    },
    {
      "name": "delete_user_directive_dependency",
      "file_path": "src/aifp/helpers/user_directives/tools/dependency_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Delete dependency record.",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "Use when dependency is no longer needed",
        "Does not uninstall the package - only removes database record",
        "If required=true was set, verify directive can still function"
      ],
      "error_handling": "Return error if id not found.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "dependency_mutations"
    },
    {
      "name": "add_user_directive_implementation",
      "file_path": "src/aifp/helpers/user_directives/tools/implementation_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Link directive to generated implementation code file.",
      "parameters": [
        {"name": "directive_id", "type": "int", "required": true},
        {"name": "implementation_type", "type": "str", "required": true},
        {"name": "file_path", "type": "str", "required": true},
        {"name": "function_name", "type": "str", "required": true},
        {"name": "language", "type": "str", "required": true},
        {"name": "framework", "type": "str", "required": false, "default": null},
        {"name": "entry_point", "type": "str", "required": true},
        {"name": "deployed", "type": "bool", "required": true},
        {"name": "deployed_at", "type": "str", "required": false, "default": null},
        {"name": "process_id", "type": "int", "required": false, "default": null},
        {"name": "file_checksum", "type": "str", "required": true}
      ],
      "return_statements": [
        "Create this after generating implementation code in src/",
        "File_path should point to actual generated file",
        "Entry_point specifies how to invoke this implementation",
        "Deployed should be false initially, true after activation",
        "Store process_id when background service starts"
      ],
      "error_handling": "Return error if directive_id not found or file doesn't exist.",
      "used_by_directives": ["user_directive_implement"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "implementation_mutations"
    },
    {
      "name": "update_user_directive_implementation",
      "file_path": "src/aifp/helpers/user_directives/tools/implementation_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update implementation metadata. All parameters except id optional.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "directive_id", "type": "int", "required": false, "default": null},
        {"name": "implementation_type", "type": "str", "required": false, "default": null},
        {"name": "file_path", "type": "str", "required": false, "default": null},
        {"name": "function_name", "type": "str", "required": false, "default": null},
        {"name": "language", "type": "str", "required": false, "default": null},
        {"name": "framework", "type": "str", "required": false, "default": null},
        {"name": "entry_point", "type": "str", "required": false, "default": null},
        {"name": "deployed", "type": "bool", "required": false, "default": null},
        {"name": "deployed_at", "type": "str", "required": false, "default": null},
        {"name": "process_id", "type": "int", "required": false, "default": null},
        {"name": "file_checksum", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "Update file_checksum when implementation code changes",
        "Set deployed=true and deployed_at when activating",
        "Update process_id when starting/restarting background service",
        "If file_path changes, verify old file still exists or clean up"
      ],
      "error_handling": "Return error if id not found or no update values provided.",
      "used_by_directives": ["user_directive_activate", "user_directive_update"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "implementation_mutations"
    },
    {
      "name": "delete_user_directive_implementation",
      "file_path": "src/aifp/helpers/user_directives/tools/implementation_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Delete implementation record. Does not delete actual code file.",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "Use when implementation is replaced or no longer valid",
        "Does not delete actual source file - only database link",
        "Manually delete source file if needed",
        "If deployed=true, must stop process first"
      ],
      "error_handling": "Return error if implementation is deployed. Must undeploy first.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "implementation_mutations"
    },
    {
      "name": "add_user_directive_relationship",
      "file_path": "src/aifp/helpers/user_directives/tools/relationship_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Create relationship between two user directives (depends_on, triggers, etc.).",
      "parameters": [
        {"name": "source_id", "type": "int", "required": true},
        {"name": "target_id", "type": "int", "required": true},
        {"name": "relationship_type", "type": "str", "required": true},
        {"name": "description", "type": "str", "required": true},
        {"name": "active", "type": "bool", "required": true}
      ],
      "return_statements": [
        "Relationship types: depends_on, triggers, escalates_to, related_to",
        "Use depends_on when source needs target to complete first",
        "Use triggers when source should execute target after completion",
        "Active=false to temporarily disable relationship",
        "Verify no circular dependencies when adding depends_on"
      ],
      "error_handling": "Return error if source_id or target_id not found, or if circular dependency.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "relationship_mutations"
    },
    {
      "name": "update_user_directive_relationship",
      "file_path": "src/aifp/helpers/user_directives/tools/relationship_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update relationship metadata. All parameters except id optional.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "source_id", "type": "int", "required": false, "default": null},
        {"name": "target_id", "type": "int", "required": false, "default": null},
        {"name": "relationship_type", "type": "str", "required": false, "default": null},
        {"name": "description", "type": "str", "required": false, "default": null},
        {"name": "active", "type": "bool", "required": false, "default": null}
      ],
      "return_statements": [
        "Use active=false to temporarily disable relationship without deleting",
        "If changing source_id or target_id, verify no circular dependencies",
        "Relationship type changes should be rare - consider delete+add instead"
      ],
      "error_handling": "Return error if id not found, or if circular dependency created.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "relationship_mutations"
    },
    {
      "name": "delete_user_directive_relationship",
      "file_path": "src/aifp/helpers/user_directives/tools/relationship_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Delete relationship between directives.",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "Use when relationship is no longer valid",
        "Verify directives can still function independently after removal",
        "Consider setting active=false instead of deleting for temporary changes"
      ],
      "error_handling": "Return error if id not found.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "relationship_mutations"
    },
    {
      "name": "add_user_helper_function",
      "file_path": "src/aifp/helpers/user_directives/tools/helper_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Add AI-generated helper function for user directives.",
      "parameters": [
        {"name": "name", "type": "str", "required": true},
        {"name": "file_path", "type": "str", "required": true},
        {"name": "parameters", "type": "str", "required": true},
        {"name": "purpose", "type": "str", "required": true},
        {"name": "error_handling", "type": "str", "required": true},
        {"name": "function_signature", "type": "str", "required": true},
        {"name": "return_type", "type": "str", "required": true},
        {"name": "is_pure", "type": "bool", "required": true},
        {"name": "implementation_status", "type": "str", "required": true}
      ],
      "return_statements": [
        "AI generates these helpers during user_directive_implement",
        "Implementation_status: not_implemented → generated → tested → approved",
        "All user helpers must be FP-compliant (is_pure=true preferred)",
        "After adding, create directive_helpers associations as needed"
      ],
      "error_handling": "Return error if name already exists or required fields invalid.",
      "used_by_directives": ["user_directive_implement"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "helper_mutations"
    },
    {
      "name": "update_user_helper_function",
      "file_path": "src/aifp/helpers/user_directives/tools/helper_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update helper function metadata. All parameters except id optional.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "name", "type": "str", "required": false, "default": null},
        {"name": "file_path", "type": "str", "required": false, "default": null},
        {"name": "parameters", "type": "str", "required": false, "default": null},
        {"name": "purpose", "type": "str", "required": false, "default": null},
        {"name": "error_handling", "type": "str", "required": false, "default": null},
        {"name": "function_signature", "type": "str", "required": false, "default": null},
        {"name": "return_type", "type": "str", "required": false, "default": null},
        {"name": "is_pure", "type": "bool", "required": false, "default": null},
        {"name": "implementation_status", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "Update implementation_status as helper progresses through lifecycle",
        "If function_signature changes, verify all calls are still valid",
        "If is_pure changes to false, review if side effects are necessary"
      ],
      "error_handling": "Return error if id not found or no update values provided.",
      "used_by_directives": ["user_directive_implement"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "helper_mutations"
    },
    {
      "name": "delete_user_helper_function",
      "file_path": "src/aifp/helpers/user_directives/tools/helper_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Delete user helper function. Checks for directive associations first.",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "Check directive_helpers table for associations before deleting",
        "If helper is used by directives, either reassign or remove associations first",
        "Does not delete actual code file - only database entry",
        "Manually update/delete code file if needed"
      ],
      "error_handling": "Return error if helper is still associated with directives.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": ["get_user_directive_helpers_by_function"],
      "category": "helper_mutations"
    },
    {
      "name": "add_user_directive_helper",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_helper_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Associate helper function with directive workflow.",
      "parameters": [
        {"name": "directive_id", "type": "int", "required": true},
        {"name": "function_id", "type": "int", "required": true},
        {"name": "execution_context", "type": "str", "required": true},
        {"name": "sequence_order", "type": "int", "required": true},
        {"name": "is_required", "type": "bool", "required": true},
        {"name": "parameters_mapping", "type": "str", "required": true},
        {"name": "description", "type": "str", "required": true}
      ],
      "return_statements": [
        "Execution_context describes when helper is called (e.g., 'validation_step', 'execution_step')",
        "Sequence_order determines call order - lower numbers execute first",
        "Is_required=true means directive cannot execute without this helper",
        "Parameters_mapping stores JSON of how to map directive data to helper parameters"
      ],
      "error_handling": "Return error if directive_id or function_id not found.",
      "used_by_directives": ["user_directive_implement"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_helper_mutations"
    },
    {
      "name": "update_user_directive_helper",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_helper_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update directive-helper association. All parameters except id optional.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "directive_id", "type": "int", "required": false, "default": null},
        {"name": "function_id", "type": "int", "required": false, "default": null},
        {"name": "execution_context", "type": "str", "required": false, "default": null},
        {"name": "sequence_order", "type": "int", "required": false, "default": null},
        {"name": "is_required", "type": "bool", "required": false, "default": null},
        {"name": "parameters_mapping", "type": "str", "required": false, "default": null},
        {"name": "description", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "If sequence_order changes, verify no conflicts with other helpers",
        "If is_required changes to false, ensure directive has fallback logic",
        "Parameters_mapping updates should be tested before deploying"
      ],
      "error_handling": "Return error if id not found or no update values provided.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_helper_mutations"
    },
    {
      "name": "delete_user_directive_helper",
      "file_path": "src/aifp/helpers/user_directives/tools/directive_helper_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Remove helper association from directive.",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "Use when helper is no longer needed in directive workflow",
        "If is_required was true, ensure directive can still function",
        "Does not delete actual helper function - only removes association"
      ],
      "error_handling": "Return error if id not found.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "directive_helper_mutations"
    },
    {
      "name": "add_user_source_file",
      "file_path": "src/aifp/helpers/user_directives/tools/source_file_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Track user directive source file (YAML/JSON/TXT).",
      "parameters": [
        {"name": "file_path", "type": "str", "required": true},
        {"name": "file_format", "type": "str", "required": true},
        {"name": "file_checksum", "type": "str", "required": true},
        {"name": "last_parsed_at", "type": "str", "required": true},
        {"name": "parse_status", "type": "str", "required": true},
        {"name": "parse_error_message", "type": "str", "required": false, "default": null},
        {"name": "directive_count", "type": "int", "required": true},
        {"name": "active_directive_count", "type": "int", "required": true}
      ],
      "return_statements": [
        "Track source files to detect changes and trigger re-parsing",
        "File_checksum used to detect modifications",
        "Parse_status: success, failed, pending",
        "Store parse_error_message for debugging failed parses",
        "Directive_count vs active_directive_count shows which are deployed"
      ],
      "error_handling": "Return error if file_path already tracked or file doesn't exist.",
      "used_by_directives": ["user_directive_parse"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "source_file_mutations"
    },
    {
      "name": "update_user_source_file",
      "file_path": "src/aifp/helpers/user_directives/tools/source_file_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update source file tracking metadata. All parameters except id optional.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "file_path", "type": "str", "required": false, "default": null},
        {"name": "file_format", "type": "str", "required": false, "default": null},
        {"name": "file_checksum", "type": "str", "required": false, "default": null},
        {"name": "last_parsed_at", "type": "str", "required": false, "default": null},
        {"name": "parse_status", "type": "str", "required": false, "default": null},
        {"name": "parse_error_message", "type": "str", "required": false, "default": null},
        {"name": "directive_count", "type": "int", "required": false, "default": null},
        {"name": "active_directive_count", "type": "int", "required": false, "default": null}
      ],
      "return_statements": [
        "Update file_checksum when source file changes",
        "Update parse_status after re-parsing",
        "Increment active_directive_count when directive activated",
        "If file_checksum changes, trigger user_directive_update for all directives from this file"
      ],
      "error_handling": "Return error if id not found or no update values provided.",
      "used_by_directives": ["user_directive_update"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "source_file_mutations"
    },
    {
      "name": "delete_user_source_file",
      "file_path": "src/aifp/helpers/user_directives/tools/source_file_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Remove source file tracking. Checks for active directives first.",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "Verify active_directive_count=0 before deleting",
        "If directives exist, must deactivate/delete them first",
        "Does not delete actual source file - only database tracking"
      ],
      "error_handling": "Return error if active directives exist for this source file.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": ["get_user_directives_by_source_file"],
      "category": "source_file_mutations"
    },
    {
      "name": "add_user_logging_config",
      "file_path": "src/aifp/helpers/user_directives/tools/logging_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Create logging configuration for user directives execution and error logs.",
      "parameters": [
        {"name": "execution_logs_enabled", "type": "bool", "required": true},
        {"name": "execution_log_rotation", "type": "bool", "required": true},
        {"name": "execution_log_retention_days", "type": "int", "required": true},
        {"name": "execution_log_compress_after_days", "type": "int", "required": true},
        {"name": "execution_log_max_size_mb", "type": "int", "required": true},
        {"name": "error_logs_enabled", "type": "bool", "required": true},
        {"name": "error_log_rotation", "type": "bool", "required": true},
        {"name": "error_log_retention_days", "type": "int", "required": true},
        {"name": "error_log_max_size_mb", "type": "int", "required": true},
        {"name": "error_log_format", "type": "str", "required": true},
        {"name": "store_execution_statistics", "type": "bool", "required": true},
        {"name": "store_last_error_only", "type": "bool", "required": true},
        {"name": "store_execution_history", "type": "bool", "required": true},
        {"name": "execution_log_dir", "type": "str", "required": true},
        {"name": "error_log_dir", "type": "str", "required": true},
        {"name": "lifecycle_log_path", "type": "str", "required": true}
      ],
      "return_statements": [
        "Typically only one logging config exists per project",
        "Default: execution_log_retention_days=30, error_log_retention_days=90",
        "Logs stored in .aifp-project/logs/ directory",
        "Enable rotation to prevent disk space issues",
        "Store_execution_history controls if detailed logs go to files"
      ],
      "error_handling": "Return error if logging config already exists (only one allowed).",
      "used_by_directives": ["user_directive_activate"],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "logging_mutations"
    },
    {
      "name": "update_user_logging_config",
      "file_path": "src/aifp/helpers/user_directives/tools/logging_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Update logging configuration. All parameters except id optional.",
      "parameters": [
        {"name": "id", "type": "int", "required": true},
        {"name": "execution_logs_enabled", "type": "bool", "required": false, "default": null},
        {"name": "execution_log_rotation", "type": "bool", "required": false, "default": null},
        {"name": "execution_log_retention_days", "type": "int", "required": false, "default": null},
        {"name": "execution_log_compress_after_days", "type": "int", "required": false, "default": null},
        {"name": "execution_log_max_size_mb", "type": "int", "required": false, "default": null},
        {"name": "error_logs_enabled", "type": "bool", "required": false, "default": null},
        {"name": "error_log_rotation", "type": "bool", "required": false, "default": null},
        {"name": "error_log_retention_days", "type": "int", "required": false, "default": null},
        {"name": "error_log_max_size_mb", "type": "int", "required": false, "default": null},
        {"name": "error_log_format", "type": "str", "required": false, "default": null},
        {"name": "store_execution_statistics", "type": "bool", "required": false, "default": null},
        {"name": "store_last_error_only", "type": "bool", "required": false, "default": null},
        {"name": "store_execution_history", "type": "bool", "required": false, "default": null},
        {"name": "execution_log_dir", "type": "str", "required": false, "default": null},
        {"name": "error_log_dir", "type": "str", "required": false, "default": null},
        {"name": "lifecycle_log_path", "type": "str", "required": false, "default": null}
      ],
      "return_statements": [
        "Changes take effect immediately for new directive executions",
        "Changing retention_days triggers cleanup of old logs beyond new retention",
        "If disabling logs, consider backing up existing logs first",
        "Log directory changes require moving existing log files"
      ],
      "error_handling": "Return error if id not found or no update values provided.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "logging_mutations"
    },
    {
      "name": "delete_user_logging_config",
      "file_path": "src/aifp/helpers/user_directives/tools/logging_mutation_tools.py",
      "database": "user_directives.db",
      "purpose": "Delete logging configuration. Reverts to default logging behavior.",
      "parameters": [
        {"name": "id", "type": "int", "required": true}
      ],
      "return_statements": [
        "Use with caution - removes all logging configuration",
        "Does not delete actual log files - only database config",
        "After deletion, directives will use default logging settings",
        "Consider updating config instead of deleting"
      ],
      "error_handling": "Return error if id not found.",
      "used_by_directives": [],
      "is_tool": false,
      "is_sub_helper": false,
      "calls_helpers": [],
      "category": "logging_mutations"
    }
  ]
}
